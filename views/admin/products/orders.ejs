<% layout('admin/layouts/boilerplate') %>

<h1>All Orders</h1>

<% if (orders.length > 0) { %>
    <% orders.forEach(order => { %>
        <div class="order">
            <h2>Order ID: <%= order._id %></h2>
            <p>User: <%= order.user.username %> (<%= order.user.email %>)</p>
            <p>Status: <%= order.status %></p>
            <p>Total Price: $<%= order.totalPrice %></p>
            <ul>
                <% order.items.forEach(item => { %>
                    <li>
                        <%= item.product.title %> - $<%= item.product.price %> x <%= item.quantity %>
                    </li>
                <% }) %>
            </ul>
            <form action="/admin/orders/<%= order._id %>" method="POST">
                <select name="status">
                    <option value="Pending" <%= order.status === 'Pending' ? 'selected' : '' %>>Pending</option>
                    <option value="Processing" <%= order.status === 'Processing' ? 'selected' : '' %>>Processing</option>
                    <option value="Shipped" <%= order.status === 'Shipped' ? 'selected' : '' %>>Shipped</option>
                    <option value="Delivered" <%= order.status === 'Delivered' ? 'selected' : '' %>>Delivered</option>
                </select>
                <button type="submit">Update Status</button>
            </form>
        </div>
    <% }) %>
<% } else { %>
    <p>No orders found.</p>
<% } %>